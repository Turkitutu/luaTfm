xml=[[<C><P D="x_bouboum/x_fond/x_f0.jpg" /><Z><S><S L="10" X="-5" H="400" Y="200" T="12" P="0,0,0,0,0,0,0,0" /><S L="10" H="400" X="805" Y="200" T="12" P="0,0,0,0,0,0,0,0" /><S L="200" X="100" H="135" Y="385" T="10" P="0,0,0.3,0,0,0,0,0" /><S L="200" H="135" X="300" Y="385" T="10" P="0,0,0.3,0,0,0,0,0" /><S L="200" X="500" H="135" Y="385" T="10" P="0,0,0.3,0,0,0,0,0" /><S L="200" H="135" X="700" Y="385" T="10" P="0,0,0.3,0,0,0,0,0" /></S><D /><O /></Z></C>]]
Admins= {Turkitutu=true, Unlocker001=true}
currentQuestion=1
tfm.exec.disableAutoShaman(true)
tfm.exec.disableAutoNewGame(true)
system.disableChatCommandDisplay("mc")
system.disableChatCommandDisplay("rv")
system.disableChatCommandDisplay("st")
system.disableChatCommandDisplay("killall")

questions={
    {
        q="في أي سنة تم إنشاء لعبة ترانسفورمايس ؟",
        a={"2010","2008","2011","2012"},
    },
    {
        q="ماهو سعر فراء الفهد الثلجيّ بالجبنة ؟",
        a={"7000","5500","6000","10000"},
    },
    {
        q="ماهي عاصمة الجزائر؟",
        a={"الجزائر","القاهرة","دار البيضاء","طرابلس"},
    },
    {
        q="ماهو الإيعاز الذي يجعل فأرك يرفع علم بلادك؟",
        a={"./f","./tk","./inv","./silence"},
    },
    {
        q="كيف نحصل على وسام الكعكة ؟",
        a={"أداء حركات معينة","الفوز بقبعة الكعكة","إهداء فرو لصديق","انهاء احدى المواسم"},
    },
    {
        q="ماهي عاصمة فرنسا ؟",
        a={"باريس","ألمانيا","قبرص","سفاقس"},
    },
    {
        q="ما الباب الذي يستحيل فتحُه؟",
        a={"الباب المفتوح","الباب الصغير","الباب الحديدي","الباب الكبير"},
    },
    {
        q="كم يمكن ان تمنح ال10 تذكرة ذهبية من الجبنة؟",
        a={"20","10","50","100"},
    },
    {
        q="ماهو أقصى حد لجبن المخزن ؟",
        a={"200","80","150","250"},
    },
    {
        q="ماهو اسم إلهة فئران لعبة ترانسفورمايس ؟",
        a={"Elisah","Lananah","Anvil God","Elise"},
    },
    { 
        q="من هو صاحب العضوية رقم 1 ؟",
        a={"Tigrounette","Noisette","Jade","Melibellule"},
    },
    {
        q="ما هي لغة النمسا ؟",
        a={"اللغة الألمانية","اللغة النمساوية","اللغة البريطانية","اللغة العربية"},
    },
    {
        q="كم من موجب حتى يصبح موضوع المقهى باللون الاخضر",
        a="10","20","15","5"},
    },
    {
        q="ما هي أعلى أغنية حصدت مشاهدات داخل اليوتيوب ؟",
        a={"Despacito","Gangnam style","Monster","See you again"},
    },
    {
        q="كم الحد الأقصى لعدد الأصدقاء الذي يمكن إضافتهم في قائمة أصدقائك ؟",
        a={"500","250","300","2000"},
    },
    {
        q="أي منهما ليس من فصيلة الطيور؟",
        a={"الخفاش","النسر","الحمامة","الدجاجة"},
    },
    {
        q="كم عدد أصابع يد الانسان ؟",
        a={"5","6","10","12"},
    },
    {
        q="مااسم صوت الأسد ؟",
        a={"الزئير","ضغيب","خوار","ليس له صوت"}
    },
    {
        q="ماهي الدولة الأخيرة التي تحتفل برأس السنة الجديدة؟",
        a={"جزيرة بيكر","فرنسا","الإمارات","الجزائر"},
    },
    {
        q="متى ظهر نظام النجوم (★) في الألقاب ؟",
        a={"2013","2010","2015","2012"},
    },
    {
        q="(3+6)-(5-1)ماهو ناتج العملية",
        a={"5","4","0","10"},
    },
    {
        q="ماهي نتيجة 54+851",
        a={"905","902","898","923"},
    },
    {
        q="كم الحد الأقصى للمواضيع التي يمكن مشاهدتها في المقهي ؟",
        a={"20","25","15","10"},
    },
    {
        q="ما هي مدة الحظر للمرة الثانية من قبل المشرف؟",
        a={"720","360","24","1440"},
    },
    {
        q="من خاتم الأنبياء؟",
        a={"النبي محمد","النبي موسى","النبي عيسى","النبي زكريا"},
    },
    {
        q="كم عدد أرجل الأخطبوط ؟",
        a={"8","12","4","6"},
    },
    {
        q="من رسم الفتاة ذات القرط اللؤلؤي ؟",
        a={"يوهانس فيرمير","ليوناردو ديفينشي","بابلو بيكاسو","مايكل أنجلو"},
    },
    {
        q="كم الحد الأقصى لعدد الأشخاص الذي يمكن ضمهم في لقبيلتك ؟",
        a={"2000","3300","2500","1500"},
    },
    {
        q="ما هي عاصمةُ الصين ؟",
        a={"بكين","هونج كونج","شنغاي","ووهان"},
    },
    {
        q="من هو اثرى رجل بالعالم حاليًا؟",
        a={"Jeff Bezos","Bill Gates","Mark Zuckerberg","Michael Bloomberg"}
    },
}
 
function table.shuffle(t)
    local t = t
    local n = #t
    local j
    for i = 1, n do
        j = math.random(i)
        t[j],t[i] = t[i],t[j]
    end
    return t
end


function eventChatCommand(n,c)
    local args={}
    for s in c:gmatch("%S+") do
        table.insert(args, s)
    end
    if Admins[n] and c:sub(0,2)=="mc" then
        tfm.exec.chatMessage("<J>"..c:sub(3).." <BV>["..n.."]")
    end
    if Admins[n] and args[1]=="st" then
        currentQuestion = tonumber(args[2])
    end
    if Admins[n] and c == "killall" then
        for n in pairs(tfm.get.room.playerList) do
            tfm.exec.killPlayer(n)
        end
    end
    if Admins[n] and args[1] == "rv" then
        tfm.exec.respawnPlayer(args[2])
    end
end
function displayQuestion(num)
    ui.addTextArea(1,"<p align='center'><font size='32'>"..questions[num].q.."</font></p>",nil,00,50,800,nil,0x324650,0x212F36,0,true)
      correctAnswer=questions[num].a[1]
      shuffledAnswers = table.shuffle(questions[num].a)
    for k,v in ipairs(shuffledAnswers) do
        ui.addTextArea(1+k,"<font color='#00000'><p align='center'><font size='18'>"..v.."</font></p>",nil,(k-1)*200,350,200,nil,0x324650,0x212F36,0,true)
    end
      tfm.exec.setGameTime(14)
      ap = ""
        for n in pairs(tfm.get.room.playerList)do
            ap=ap..", "..n
        end
        print(ap)
      print(currentQuestion)
end

function eventPopupAnswer(id,n,a)
    local fc = a:gsub("<", "&lt;")
    tfm.exec.chatMessage("<J>"..fc.." <BV>["..n.."]")
    ui.addPopup(id, 2, "Enter text", n, 0, 350, 300, true)
end
 
function eventLoop(time, remaining)
      if remaining<=0 and not VARIABLENAME then
        VARIABLENAME=true
        if questions[currentQuestion] then
            for k,v in ipairs(shuffledAnswers) do
                if v==correctAnswer then
                    correctAnswer=k
                end
            end
            for name,player in pairs(tfm.get.room.playerList) do
                if (not player.isDead) and not (player.x<correctAnswer*200 and player.x>(correctAnswer*200)-200) then
                    tfm.exec.killPlayer(name)
                end
            end
              currentQuestion=currentQuestion+1
            if questions[currentQuestion] then
                 VARIABLENAME=false
                 displayQuestion(currentQuestion)
            else
                VARIABLENAME=false
            end

          else
              for i=1,5 do ui.removeTextArea(i) end
              ui.addTextArea(1,"<p align='center'><font size='32'>That's all there is!</font></p>",nil,200,50,400,nil,0x324650,0x212F36,0,true)
          end
    end
end

function eventNewGame()
    for n in pairs(tfm.get.room.playerList) do
        if Admins[n] then
            tfm.exec.setNameColor(n, 0xF0173A)
        end
    end
end
 
tfm.exec.newGame(xml)
displayQuestion(currentQuestion)